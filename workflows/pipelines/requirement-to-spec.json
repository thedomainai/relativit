{
  "name": "requirement-to-spec",
  "version": "1.0.0",
  "description": "Automated pipeline to transform requirements into technical specifications",
  "trigger": {
    "type": "event",
    "events": ["requirement.approved"],
    "conditions": {
      "requirement.status": "approved"
    }
  },
  "stages": [
    {
      "id": "analyze",
      "name": "Analyze Requirements",
      "type": "ai_task",
      "agent": "requirement_analyzer",
      "inputs": ["requirement"],
      "outputs": ["analysis_result"],
      "config": {
        "prompt_template": ".agent/prompts/task/analyze_requirement.md",
        "confidence_threshold": 0.8
      }
    },
    {
      "id": "design",
      "name": "Design Specification",
      "type": "ai_task",
      "agent": "spec_designer",
      "inputs": ["analysis_result", "architecture_context"],
      "outputs": ["draft_spec"],
      "config": {
        "prompt_template": ".agent/prompts/task/design_specification.md",
        "include_alternatives": true
      }
    },
    {
      "id": "validate",
      "name": "Validate Specification",
      "type": "validation",
      "validator": "spec_validator",
      "inputs": ["draft_spec"],
      "outputs": ["validation_result"],
      "rules": [
        "validation/rules/specs.json"
      ]
    },
    {
      "id": "decide",
      "name": "Decision Point",
      "type": "decision",
      "condition": "validation_result.passed == true",
      "on_success": "finalize",
      "on_failure": "refine"
    },
    {
      "id": "refine",
      "name": "Refine Specification",
      "type": "ai_task",
      "agent": "spec_refiner",
      "inputs": ["draft_spec", "validation_result"],
      "outputs": ["refined_spec"],
      "next": "validate"
    },
    {
      "id": "finalize",
      "name": "Finalize Specification",
      "type": "storage",
      "action": "save",
      "destination": "specs/",
      "inputs": ["draft_spec"],
      "metadata": {
        "auto_generated": true,
        "source_requirement": "{{requirement.id}}"
      }
    }
  ],
  "error_handling": {
    "retry_attempts": 3,
    "fallback": "human_review"
  },
  "logging": {
    "enabled": true,
    "level": "detailed",
    "destination": "monitoring/logs/"
  }
}
